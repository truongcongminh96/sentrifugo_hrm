TYPE=TRIGGERS
triggers='CREATE DEFINER=`root`@`%` TRIGGER `main_users_aft_upd` AFTER UPDATE ON `main_users` \n				    FOR EACH ROW BEGIN\n				    declare groupid int(11);\n				    \n				    select group_id into groupid from main_roles where id = old.emprole;\n				    if old.userfullname != new.userfullname then\n				    begin \n				    \n				    if (groupid != 5 or groupid is null) then \n				    begin\n					#start of main_leaverequest_summary\n				        update main_leaverequest_summary set rep_manager_name = new.userfullname,modifieddate = utc_timestamp() where rep_mang_id = new.id and isactive = 1;\n				        update main_leaverequest_summary set user_name = new.userfullname,modifieddate = utc_timestamp() where user_id = new.id and isactive = 1; \n					#end of main_leaverequest_summary\n					#start of main_requisition_summary\n					update main_requisition_summary set reporting_manager_name = new.userfullname,modifiedon = utc_timestamp() where reporting_id = new.id and isactive = 1;\n					update main_requisition_summary set approver1_name = new.userfullname,modifiedon = utc_timestamp() where approver1 = new.id and isactive = 1;\n					update main_requisition_summary set approver2_name = new.userfullname,modifiedon = utc_timestamp() where approver2 = new.id and isactive = 1;\n					update main_requisition_summary set approver3_name = new.userfullname,modifiedon = utc_timestamp() where approver3 = new.id and isactive = 1;\n					update main_requisition_summary set createdby_name = new.userfullname,modifiedon = utc_timestamp() where createdby = new.id and isactive = 1;\n					#end of main_requisition_summary\n					#start of main_employees_summary\n					update main_employees_summary set reporting_manager_name = new.userfullname,modifieddate = utc_timestamp() where reporting_manager = new.id and isactive = 1;\n					update main_employees_summary set referer_name = new.userfullname,modifieddate = utc_timestamp() where candidatereferredby = new.id and isactive = 1;\n					update main_employees_summary set createdby_name = new.userfullname,modifieddate = utc_timestamp() where createdby = new.id and isactive = 1;\n				        update main_employees_summary set userfullname = new.userfullname,modifieddate = utc_timestamp() where user_id = new.id and isactive = 1;\n					#end of main_employees_summary\n					#start of main_bgchecks_summary\n					update main_bgchecks_summary set specimen_name = new.userfullname,modifieddate = utc_timestamp() where specimen_id = new.id and specimen_flag = 1 and isactive = 1;\n					update main_bgchecks_summary set createdname = new.userfullname,modifieddate = utc_timestamp() where createdby = new.id and isactive = 1;\n					update main_bgchecks_summary set modifiedname = new.userfullname,modifieddate = utc_timestamp() where modifiedby = new.id and isactive = 1;\n					#end of main_bgchecks_summary\n					# start of main_interviewrounddetails_summary\n					update main_interviewrounds_summary set interviewer_name = new.userfullname,modified_date = utc_timestamp() where interviewer_id = new.id and isactive = 1;\n					update main_interviewrounds_summary set created_by_name = new.userfullname,modified_date = utc_timestamp() where created_by = new.id and isactive = 1;\n					# end of main_interviewrounddetails_summary\n					# start of main_userloginlog\n					update main_userloginlog set userfullname = new.userfullname where userid = new.id;\n					# end of main_userloginlog\n					#start of main_sdrequests_summary\n					update main_sd_requests_summary set raised_by_name = new.userfullname,modifieddate = utc_timestamp() where raised_by = new.id;\n					update main_sd_requests_summary set executor_name = new.userfullname,modifieddate = utc_timestamp() where executor_id = new.id;\n					update main_sd_requests_summary set reporting_manager_name = new.userfullname,modifieddate = utc_timestamp() where reporting_manager_id = new.id;\n					update main_sd_requests_summary set approver_1_name = new.userfullname,modifieddate = utc_timestamp() where approver_1 = new.id;	\n					update main_sd_requests_summary set approver_2_name = new.userfullname,modifieddate = utc_timestamp() where approver_2 = new.id;\n					update main_sd_requests_summary set approver_3_name = new.userfullname,modifieddate = utc_timestamp() where approver_3 = new.id;\n					# end of main_sdrequests_summary	\n				    end;\n				    end if;\n				    end;\n				    end if;#end of if of user full name\n				    if old.employeeId != new.employeeId then \n				    begin \n				        if (groupid != 5 or groupid is null) then \n				        begin\n					    #start of main_employees_summary\n				            update main_employees_summary set employeeId = new.employeeId,modifieddate = utc_timestamp() where user_id = new.id; \n				            #end of main_employees_summary\n				        end;\n				        end if;\n				    end;\n				    end if;#end of if of employeeId\n				    if old.isactive != new.isactive then\n				    begin\n					if (groupid != 5 or groupid is null) then \n				        begin\n					    #start of main_employees_summary\n				            update main_employees_summary set isactive = new.isactive,modifieddate = utc_timestamp() where user_id = new.id; \n				            #end of main_employees_summary\n				        end;\n				        end if;\n				    end;\n				    end if; #end of if of isactive\n				    if old.profileimg != new.profileimg then\n				    begin\n					if (groupid != 5 or groupid is null) then \n				        begin\n					    #start of main_employees_summary\n				            update main_employees_summary set profileimg = new.profileimg,modifieddate = utc_timestamp() where user_id = new.id; \n				            #end of main_employees_summary\n					    #start of main_request_history\n				            update main_request_history set emp_profileimg = new.profileimg,modifieddate = utc_timestamp() where emp_id = new.id; \n				            #end of main_request_history\n				        end;\n				        end if;\n				    end;\n				    end if; #end of if of isactive\n				    if old.backgroundchk_status != new.backgroundchk_status then\n				    begin\n					if (groupid != 5 or groupid is null) then \n				        begin\n					    #start of main_employees_summary\n				            update main_employees_summary set backgroundchk_status = new.backgroundchk_status,modifieddate = utc_timestamp() where user_id = new.id; \n				            #end of main_employees_summary\n				        end;\n				        end if;\n				    end;\n				    end if;#end of if of background check status\n				if (old.contactnumber != new.contactnumber || new.contactnumber IS NOT NULL) then\n				    begin\n					if (groupid != 5 or groupid is null) then \n				        begin\n					    #start of main_employees_summary\n				            update main_employees_summary set contactnumber = new.contactnumber,modifieddate = utc_timestamp() where user_id = new.id; \n				            #end of main_employees_summary\n				        end;\n				        end if;\n				    end;\n				    end if;#end of if of contact number\n				    \n				    END'
sql_modes=0
definers='root@%'
client_cs_names='utf8'
connection_cl_names='utf8_general_ci'
db_cl_names='latin1_swedish_ci'
